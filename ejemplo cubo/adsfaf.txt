select * from Orders

--MontoVentas, CantidadOrdenes, Descuentos, MontoDescuento,

--Montos generales

Select 
sum(od.Quantity * od.UnitPrice)	as MontoTotal --Monto total 
,sum((od.Quantity * od.UnitPrice)- (od.Quantity * od.UnitPrice * od.Discount)) as MontoDescuento
, sum(od.Quantity * od.UnitPrice * od.Discount) as Descuentos 
,count(Distinct OrderID) as Cantidad
from [Order Details] od  

--creacion de la vista de facturas

Create view FactOrders
as
Select 
o.OrderID,
o.CustomerID,
o.EmployeeID,
o.OrderDate,
o.ShipVia,
sum(od.Quantity * od.UnitPrice)	as MontoTotal --Monto total 
,round(sum((od.Quantity * od.UnitPrice)- (od.Quantity * od.UnitPrice * od.Discount)),2) as MontoDescuento
, round(sum(od.Quantity * od.UnitPrice * od.Discount),2) as Descuentos 
,count(Distinct od.OrderID) as Cantidad
from [Order Details] od  
inner join Orders o
on o.OrderID=od.OrderID
Group by
o.OrderID,
o.CustomerID,
o.EmployeeID,
o.OrderDate,
o.ShipVia

--Creacion de vista para tablas dimensionales

Create view DimCustomers
as
select * from Customers

--Dimension de empleados

Create view DimEmployees 
as
select* from Employees

--Dimension de formas de envio

Create view DimShipVIA
as 
select * from Shippers

--Dimension de fechas
create view DimDate
as
select Distinct OrderDate,  
year(OrderDate) as a√±o,
month(OrderDate) as mes,
day(OrderDate) as dia,
DATEPART(QUARTER,OrderDate) as cuatrimestre
from Orders

